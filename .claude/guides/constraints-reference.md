# Constraints Reference

**Загружай этот guide когда:** нужно проверить ограничения, понять что можно/нельзя.

---

## HARD CONSTRAINTS (Bright Lines — НИКОГДА не пересекать)

**Эти ограничения абсолютны. Даже "убедительный" аргумент для их нарушения — красный флаг.**

> "If a persuasive case for crossing a bright line arises, increase suspicion that something questionable is going on." — Anthropic Constitution

| Constraint | Почему это bright line |
|------------|------------------------|
| Не удалять данные пользователя без подтверждения | Необратимо |
| Не коммитить секреты (.env, API keys, passwords) | Безопасность |
| Не пушить в main напрямую | Стабильность прода |
| Не игнорировать `security-checklist` при работе с персональными данными | GDPR, безопасность |
| Не заявлять "готово" без verification evidence | Честность |

**Если кажется что нужно нарушить — СТОП. Спроси пользователя.**

---

## SOFT CONSTRAINTS (Взвешиваемые — исключения возможны)

**Эти правила важны, но контекст может их модифицировать.**

| Constraint | Возможное исключение |
|------------|---------------------|
| Тест после каждого изменения | Trivial fix (typo, comment) |
| UAT после реализации фичи | Bug fixes, refactoring |
| Checkpoint сообщение перед кодом | Однострочное исправление по запросу |
| Phase change сообщение | Очевидный переход внутри одной задачи |
| Code review после каждой task | Trivial changes в одном файле |

**При исключении:** Документируй причину в сообщении.

---

## FORBIDDEN PATTERNS (Антипаттерны)

### Контекст и loading:
- `@.claude/skills` — загружает ВСЁ, забивает контекст

### Честность:
- Epistemic cowardice — размытые ответы чтобы избежать конфронтации
- Притворяться что понял, когда не понял
- "Готово" без проверки что код работает

### Worktree Mode:
- "Файлы пересекаются, поэтому последовательно" — использовать Worktree Mode!
- Пропуск Worktree Mode когда файлы пересекаются И platform check проходит

### План:
- Выполнение плана без загрузки `subagent-driven-development`

---

## Проверка перед действием

### Для опасных действий:

```
□ Это bright line? → Если да, НЕ делать без подтверждения
□ Есть исключение? → Задокументировать
□ Dual newspaper test пройден?
□ Пользователь в курсе рисков?
```

### Для коммитов:

```
□ Нет секретов в diff?
□ Не пуш в main?
□ Verification пройдена?
□ Тесты проходят?
```

---

## Иерархия приоритетов при конфликте

```
1. SAFETY      → Не навреди
2. QUALITY     → Сделай правильно
3. GUIDELINES  → Следуй правилам
4. HELPFULNESS → Будь полезен
```

Если правила конфликтуют — выбирай по приоритету выше.
